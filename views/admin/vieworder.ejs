<%- include('../admin/adminHeader')%>
    <!DOCTYPE html>
    <html>

    <head>
        <title>Products</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
        <script type="text/javascript" charset="utf8"
            src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <link rel="stylesheet" href="https://cdn.datatables.net/1.13.2/css/dataTables.bootstrap4.min.css">
        <link rel="stylesheet" href="/public/css/orders.css">
    </head>

    <body>
        <div class="container" style="margin-top: 6rem;">
            <div class="d-flex justify-content-center">
            </div>
            <section>
                <div class="container">
                    <div class="row d-flex justify-content-center align-items-center">
                        <div class="col-10">
                            <div class="d-flex justify-content-center align-items-center" style="color:rgb(34, 14, 54)">
                                <h3 class="fw-normal mb-0 text-black">
                                    <%= %>
                                </h3>
                            </div>

                            <% if (productDetails.length> 0) {
                                for (let i = 0; i < productDetails.length; i++) { %>
                                    <div class="card-body p-4">
                                        <div class="row d-flex align-items-center">
                                            <div class="col-md-2 col-lg-2 col-xl-2">
                                                <img style="width:auto;height:auto"
                                                    src="/public/productImages/<%= productDetails[i].image %>"
                                                    class="img-fluid rounded-3" alt="book">
                                            </div>
                                            <div class="col-md-3 col-lg-3 col-xl-3">
                                                <p class="lead fw-normal mb-2">
                                                    <%= productDetails[i].productname %>
                                                </p>
                                            </div>
                                            <div class="col-md-3 col-lg-2 col-xl-2">
                                                <p class="lead fw-normal mb-2">Quantity: <%= productDetails[i].quantity
                                                        %>
                                                </p>
                                            </div>

                                        </div>
                                    </div>
                                    <% } } else { %>
                                        <div>
                                            <textarea name="" id="" cols="30" rows="10">

                                            </textarea>
                                        </div>
                                        <div class="card rounded-3 mb-4">
                                            <div class="card-body p-4">
                                                <p>No orders found.</p>
                                            </div>
                                        </div>
                                        <% } %>
                                            <div class="col-10">
                                                <h3>Billing Details</h3>
                                                <form class="row contact_form" action="/payment" method="post"
                                                    novalidate="novalidate" id="form2">
                                                    <div class="col-md-12 form-group p_star">
                                                        <p>
                                                            Name: <%= orderDetails[0].name %> <br>
                                                                Address: <%= orderDetails[0].address %> <br>
                                                                    Landmark: <%= orderDetails[0].landmark %> <br>
                                                                        Street: <%= orderDetails[0].street %> <br>
                                                                            City/District: <%= orderDetails[0].city %>
                                                                                <br>
                                                                                State: <%= orderDetails[0].state %> <br>
                                                                                    Mobile: <%= orderDetails[0].mobile
                                                                                        %> <br>
                                                                                        Zip Code: <%=
                                                                                            orderDetails[0].zipcode %>
                                                                                            <br>
                                                                                            Status:
                                                                                            <select id="orderStatus"
                                                                                                onchange="updateOrderStatus('<%= orderId %>', this.value)">
                                                                                                <option value="Pending"
                                                                                                    <% if
                                                                                                    (orderDetails[0].status==='Pending'
                                                                                                    ) { %> selected <% }
                                                                                                        %>>Pending
                                                                                                </option>
                                                                                                <option value="Pending"
                                                                                                    <% if
                                                                                                    (orderDetails[0].status==='Pending'
                                                                                                    ) { %> selected <% }
                                                                                                        %>>Pending
                                                                                                </option>
                                                                                                <option
                                                                                                    value="Processing"
                                                                                                    <% if
                                                                                                    (orderDetails[0].status==='Processing'
                                                                                                    ) { %> selected <% }
                                                                                                        %>>Processing
                                                                                                </option>
                                                                                                <option value="Shipped"
                                                                                                    <% if
                                                                                                    (orderDetails[0].status==='Shipped'
                                                                                                    ) { %> selected <% }
                                                                                                        %>>Shipped
                                                                                                </option>
                                                                                                <option
                                                                                                    value="Delivered" <%
                                                                                                    if
                                                                                                    (orderDetails[0].status==='Delivered'
                                                                                                    ) { %> selected <% }
                                                                                                        %>>Delivered
                                                                                                </option>
                                                                                                <option value="Returned"
                                                                                                    <% if
                                                                                                    (orderDetails[0].status==='Returned'
                                                                                                    ) { %> selected <% }
                                                                                                        %>>Returned
                                                                                                </option>
                                                                                            </select>
                                                        </p>
                                                    </div>
                                                </form>
                                            </div>
                        </div>
                    </div>

                </div>

            </section>


        </div>
    </body>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.datatables.net/1.13.2/js/jquery.dataTables.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script>
        function updateOrderStatus(orderId, newStatus) {
            // Perform an AJAX request to update the order status
            // You can use a library like jQuery or fetch API for this

            // Example using jQuery AJAX
            $.ajax({
                url: '/admin/updateOrderStatus',
                method: 'POST',
                data: {
                    orderId: orderId,
                    newStatus: newStatus
                },
                success: function (response) {
                    // Handle the success response
                    console.log('Order status updated successfully');
                },
                error: function (xhr, status, error) {
                    // Handle the error response
                    console.error('Error updating order status:', error);
                }
            });
        }

    </script>